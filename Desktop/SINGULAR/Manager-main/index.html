<!-- File: /inventory/index.html -->
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Inventario de Obras</title>
  <link rel="stylesheet" href="styles.css" />
  <script defer src="app.js"></script>
</head>

<body>
    <!-- ICONOS -->
  <svg aria-hidden="true" focusable="false" style="position:absolute;width:0;height:0;overflow:hidden">
    <defs>
      <symbol id="i-home" viewBox="0 0 24 24"><path d="M3 10.5 12 3l9 7.5V21a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1v-10.5Z"/></symbol>
      <symbol id="i-list" viewBox="0 0 24 24"><path d="M4 6h16M4 12h16M4 18h16" stroke-width="2" stroke-linecap="round" fill="none"/></symbol>
      <symbol id="i-info" viewBox="0 0 24 24"><path d="M12 8.5a1.2 1.2 0 1 0 0-2.4 1.2 1.2 0 0 0 0 2.4ZM11 11h2v7h-2z"/><circle cx="12" cy="12" r="10" fill="none" stroke-width="1.5"/></symbol>
      <symbol id="i-plus" viewBox="0 0 24 24"><path d="M12 5v14M5 12h14" stroke-width="2" stroke-linecap="round" fill="none"/></symbol>
      <symbol id="i-edit" viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25Z"/><path d="M14.06 6.19 16.88 3.37 20.63 7.12 17.81 9.94z"/></symbol>
      <symbol id="i-trash" viewBox="0 0 24 24"><path d="M5 7h14M9 7V5h6v2m-8 0 1 12h8l1-12" stroke-width="2" stroke-linecap="round" fill="none"/></symbol>
      <symbol id="i-download" viewBox="0 0 24 24"><path d="M12 8v9m0 0 4-4m-4 4-4-4M5 20h14" stroke-width="2" stroke-linecap="round" fill="none"/></symbol>
      <symbol id="i-upload" viewBox="0 0 24 24"><path d="M12 16V7m0 0 4 4m-4-4-4 4M5 20h14" stroke-width="2" stroke-linecap="round" fill="none"/></symbol>
    </defs>
  </svg>


  <header class="app-header">
    <div class="header-row">
      <h1 class="app-title">INVOBRA</h1>
    </div>
  
    <!-- Menú/acciones de HOME -->
    <div class="toolbar" id="home-toolbar">
      <div class="row wrap">
        <select id="obraSelect" aria-label="Seleccionar Obra" style="flex:1"></select>
        <button id="nuevaObraBtn" type="button" class="btn primary"><svg class="i"><use href="#i-plus"/></svg><span>Nueva</span></button>
        <button id="editObraBtn" type="button" class="btn"><svg class="i"><use href="#i-edit"/></svg></button>
        <button id="deleteObraBtn" type="button" class="btn danger"><svg class="i"><use href="#i-trash"/></svg></button>
      </div>
      <!-- IMPORTANTE: aquí ya NO van export/import ni ¿Cómo usar? -->
      <div id="alertContainer" class="alert-region" aria-live="polite"></div>
    </div>
  </header>
  
  <main class="app-main">
    <!-- HOME: solo selección y acciones -->
    <section id="view-home" class="card view" aria-label="Inicio">
      <p class="muted">Selecciona una obra para gestionarla. Al seleccionar, te llevaremos al inventario.</p>
      <div class="separator"></div>
      <div class="row wrap">
        <select id="obraSelect-home" class="hidden"></select> <!-- no usado: mantenemos #obraSelect del header -->
      </div>
    </section>
  
    <!-- INVENTARIO: formulario + tabla (filtros ocultos) -->
    <section id="view-inventario" class="card view hidden" aria-labelledby="formTitle">
      <!-- Filtros ocultos de momento -->
      <div id="filtersSection" class="hidden"></div>
  
      <div class="separator"></div>
      <h2 id="formTitle">Agregar Ítem</h2>
      <form id="itemForm" class="grid" novalidate>
        <label><span>Nombre *</span><input id="itemNombre" required /></label>
        <label><span>Categoría *</span>
          <select id="itemCategoria" required>
            <option value="">— Seleccionar —</option>
            <option value="herramienta">Herramienta</option>
            <option value="material">Material</option>
          </select>
        </label>
        <label id="subtipoGroup"><span>Subtipo</span>
          <select id="itemSubtipo">
            <option value="">—</option>
            <option value="electrica">Eléctrica</option>
            <option value="manual">Manual</option>
          </select>
        </label>
        <label><span>Marca *</span>
          <select id="itemMarca" required>
            <option value="">—</option>
            <option value="__new__">Nueva marca…</option>
          </select>
        </label>
        <label id="marcaNuevaWrap" class="hidden"><span>Nueva marca</span><input id="itemMarcaNueva" /></label>
        <label class="full"><span>Ubicación</span><input id="itemUbicacion" placeholder="ej: Almacén 1 / Estante A" /></label>
        <label class="full"><span>Observaciones</span><textarea id="itemObservaciones" rows="3" placeholder="Notas adicionales..."></textarea></label>
        <div class="row">
          <button id="submitBtn" type="submit" class="btn primary">Agregar ítem</button>
          <button id="cancelBtn" type="reset" class="btn ghost">Cancelar</button>
        </div>
      </form>
  
      <div class="separator"></div>
      <div class="row between">
        <h2 id="inventario">Inventario</h2>
        <div class="chips">
          <span class="chip">Visibles <strong id="visibleCount">0</strong></span>
          <span class="chip">Total <strong id="totalCount">0</strong></span>
        </div>
      </div>
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>Nombre</th><th>Cat.</th><th>Subtipo</th><th>Cant.</th>
              <th>Marca</th><th>Ubicación</th><th>Observaciones</th><th>Acciones</th>
            </tr>
          </thead>
          <tbody id="tableBody">
            <tr><td colspan="8" class="empty">Selecciona una obra…</td></tr>
          </tbody>
        </table>
      </div>
    </section>
  
    <!-- AYUDA -->
    <section id="view-ayuda" class="card view hidden" aria-labelledby="como-usar">
      <h2 id="como-usar">Cómo usar</h2>
      <ol class="muted">
        <li>Selecciona una obra en la parte superior.</li>
        <li>Ve a la pestaña <b>Inventario</b> para añadir y gestionar ítems.</li>
        <li>Usa la pestaña <b>Datos</b> para exportar o importar JSON.</li>
      </ol>
    </section>
  
    <!-- DATOS: Exportar / Importar -->
    <section id="view-datos" class="card view hidden" aria-label="Datos">
      <h2>Datos</h2>
      <div class="row wrap">
        <button id="exportBtn" type="button" class="btn"><svg class="i"><use href="#i-download"/></svg><span>Exportar JSON</span></button>
        <label for="importFile" class="btn" role="button" aria-controls="importFile"><svg class="i"><use href="#i-upload"/></svg><span>Importar JSON</span></label>
        <input id="importFile" type="file" accept="application/json" class="hidden" />
      </div>
    </section>
  </main>

  <nav class="tabbar" aria-label="Navegación">
    <a href="#home" class="tab" id="nav-home"><svg class="i"><use href="#i-home"/></svg><span>Inicio</span></a>
    <a href="#inventario" class="tab" id="nav-inventario"><svg class="i"><use href="#i-list"/></svg><span>Inventario</span></a>
    <a href="#ayuda" class="tab" id="nav-ayuda"><svg class="i"><use href="#i-info"/></svg><span>Ayuda</span></a>
    <a href="#datos" class="tab" id="nav-datos"><svg class="i"><use href="#i-download"/></svg><span>Datos</span></a>
  </nav>
  

  <!-- Modal Obras -->
  <dialog id="obraModal" aria-labelledby="obraModalTitle">
    <div class="modal-header">
      <h3 id="obraModalTitle">Nueva Obra</h3>
      <button type="button" class="btn-icon" aria-label="Cerrar" data-close>✕</button>
    </div>
    <div class="modal-content">
      <form id="obraForm" novalidate>
        <label for="obraNombre"><b>Nombre de la Obra *</b></label>
        <input id="obraNombre" required />
        <div id="obraNombre-error" class="alert error hidden"></div>
        <div class="form-actions">
          <button type="submit" id="obraSubmitBtn" class="btn-dark">Crear Obra</button>
          <button type="button" id="obraCancelBtn" class="btn-secondary" data-close>Cancelar</button>
          <button type="button" id="obraDeleteBtn" class="btn-danger hidden">Eliminar Obra</button>
        </div>
      </form>
    </div>
  </dialog>
</body>
</html>
